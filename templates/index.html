<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ubik2CR - Tu cantÃ³n en tu mano</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

    <style>
        body { background-color: #f5f7fa; }

        .hero {
            background: linear-gradient(135deg, #0b4fa3, #38b24d);
            color: white;
            padding: 90px 0 80px;
            text-align: center;
        }
        .hero img { max-width: 160px; margin-bottom: 20px; }
        .hero h1 { font-weight: 800; font-size: 3rem; }
        .hero p { font-size: 1.3rem; }

        .card-negocio {
            border: none;
            border-radius: 14px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: 0.2s;
            overflow: hidden;
        }
        .card-negocio:hover { transform: translateY(-4px); }
    </style>
</head>

<body>

<!-- HEADER -->
<nav class="navbar navbar-expand-lg" style="background:linear-gradient(90deg,#0b4fa3,#38b24d);">
    <div class="container">
        <a class="navbar-brand d-flex align-items-center gap-2" href="/">
            <img src="{{ url_for('static', filename='uploads/logo.png') }}" height="55" alt="Ubik2CR">
            <strong class="text-white fs-4">Ubik2CR</strong>
        </a>

        <div class="ms-auto d-flex gap-2 flex-wrap">

            <!-- âœ… SIEMPRE VISIBLE -->
            <a href="/cuenta" class="btn btn-outline-light fw-bold">
                ğŸ‘¤ Cuenta
            </a>

            {% if session.get('admin_logged_in') %}
                <a href="/admin" class="btn btn-light fw-bold">Panel Admin</a>
                <a href="/logout" class="btn btn-outline-light">Salir</a>
            {% else %}
                <a href="/login" class="btn btn-light fw-bold">AdministraciÃ³n</a>
            {% endif %}
        </div>
    </div>
</nav>

<!-- HERO -->
<section class="hero">
    <div class="container">
        <img src="{{ url_for('static', filename='uploads/logo.png') }}" alt="Ubik2CR">
        <h1>Tu cantÃ³n en tu mano</h1>
        <p>Negocios, servicios y lugares de tu comunidad</p>

        <!-- âœ… BOTÃ“N MAPA -->
        <div class="mt-4">
            <a href="/mapa" class="btn btn-light fw-bold px-4 py-2 rounded-pill">
                ğŸ“ Ver en mapa
            </a>
        </div>
    </div>
</section>

<!-- BUSCADOR -->
<div class="container mt-5">
    <form method="get" class="row g-3">
        <div class="col-md-5">
            <input type="text" name="q" class="form-control" placeholder="Â¿QuÃ© estÃ¡s buscando?"
                   value="{{ request.args.get('q','') }}">
        </div>

        <div class="col-md-4">
            <select name="cat" class="form-select">
                <option value="Todas" {% if categoria_actual == 'Todas' %}selected{% endif %}>Todas las categorÃ­as</option>
                <option value="Iglesia" {% if categoria_actual == 'Iglesia' %}selected{% endif %}>â›ª Iglesias</option>
                <option value="Bomberos" {% if categoria_actual == 'Bomberos' %}selected{% endif %}>ğŸš’ Bomberos</option>
                <option value="Cruz Roja" {% if categoria_actual == 'Cruz Roja' %}selected{% endif %}>ğŸš‘ Cruz Roja</option>
                <option value="Gobierno" {% if categoria_actual == 'Gobierno' %}selected{% endif %}>ğŸ›ï¸ Instituciones PÃºblicas</option>
                <option value="Comercio" {% if categoria_actual == 'Comercio' %}selected{% endif %}>ğŸª Comercios</option>
                <option value="Restaurante" {% if categoria_actual == 'Restaurante' %}selected{% endif %}>ğŸ” Restaurantes</option>
                <option value="Servicios" {% if categoria_actual == 'Servicios' %}selected{% endif %}>ğŸ§° Servicios</option>
            </select>
        </div>

        <div class="col-md-3">
            <button class="btn btn-success w-100 fw-bold">Buscar</button>
        </div>
    </form>
</div>

<!-- RESULTADOS -->
<div class="container my-5">
    <div class="row g-4">
        {% for n in negocios %}
        <div class="col-md-4">
            <div class="card card-negocio h-100">
                <img src="{{ n.imagen_url if n.imagen_url else url_for('static', filename='uploads/logo.png') }}"
                     class="card-img-top"
                     style="height:200px; object-fit:cover;"
                     alt="{{ n.nombre }}"
                     onerror="this.src='https://via.placeholder.com/600x400?text=Sin+Imagen'">
                <div class="card-body">
                    <span class="badge bg-primary">{{ n.categoria }}</span>
                    <h5 class="mt-2 fw-bold">{{ n.nombre }}</h5>
                    <p class="text-muted small mb-3">{{ n.ubicacion }}</p>
                    <a href="/negocio/{{ n.id }}" class="btn btn-outline-primary w-100">Ver detalles</a>
                </div>
            </div>
        </div>
        {% else %}
        <div class="col-12">
            <div class="alert alert-light border text-center py-5">
                <h5 class="mb-2">AÃºn no hay resultados</h5>
                <div class="text-muted">ProbÃ¡ con otra bÃºsqueda o seleccionÃ¡ "Todas las categorÃ­as".</div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<footer class="text-center py-4 bg-dark text-white mt-5">
    Â© 2025 Ubik2CR â€” Todos los derechos reservados
</footer>

</body>
</html>

